<%= render :partial => 'vish_editor.full' %>

<script>	
	options = {};
	var configuration = {};

	configuration["mode"] = "vish";

	configuration["ImagesPath"] = "/assets/";
	configuration["StylesheetsPath"] = "/assets/";

	configuration["rootPath"] = "<%= ::Rails.application.config.full_domain %>";

	configuration["Upload"] = true;
	configuration["uploadImagePath"] = "<%= image_path :format=> "json" || ""%>";
	configuration["uploadObjectPath"] = "<%= image_path :format=> "json" || ""%>";
	configuration["uploadPresentationPath"] = "<%= free_learn.course_index_path :format=> "json"%>";
	configuration["uploadPDF2PPath"] = "";

	// Sources enabled
	configuration["ViSH"] = false;
	configuration["ViSH_instances"] = ["<%= ::Rails.application.config.full_domain %>"];
	configuration["Flickr"] = false;
	
	//Youtube API
	<%# unless Vish::Application.config.APP_CONFIG['YouTubeAPIKEY'].nil? %>
		// configuration["Youtube"] = true;
		// configuration["YoutubeAPIKEY"] =  "<%#= Vish::Application.config.APP_CONFIG['YouTubeAPIKEY'] %>";
	<%# end %>

	//Vimeo API
	configuration["Vimeo"] = false;
	configuration["LRE"] = false;
	configuration["LRE_path"] = "";

	//Soundcloud API
	<%# unless Vish::Application.config.APP_CONFIG['soundCloudAPIKEY'].nil? %>
		// configuration["SoundCloud"] = true;
		// configuration["SoundCloudAPIKEY"] =  "<%#= Vish::Application.config.APP_CONFIG['soundCloudAPIKEY'] %>";
	<%# end %>

	//Catalog API
	<%# if available_services.include? "Catalogue" %>
		//configuration["catalog"] = <%#= raw Vish::Application.config.catalogue["categories"].map{|c| c.capitalize}.to_json %>;
	<%# end %>

	configuration["presentationSettings"] = true;

	// var tagsSettings = new Object();
	// tagsSettings.maxLength = '<%#=Vish::Application.config.tagsSettings["maxLength"]%>';
	// tagsSettings.maxTags = '<%#=Vish::Application.config.tagsSettings["maxTags"]%>';
	// tagsSettings.triggerKeys = <%#=raw(Vish::Application.config.tagsSettings["triggerKeys"].to_json)%>;     	
	// configuration["tagsSettings"] = tagsSettings;
	
	options["configuration"] = configuration;


	options["developping"] = false;

	options["user"] = {
		name: "<%= current_user.email %>",
		id: "<%= current_user.id %>",
		token: "" //TODO: Check tokens
	};

	options["draft"] = true;

	options["lang"] = "<%= I18n.locale.to_s%>";

	options["exitURL"]  = "<%= free_learn.root_path %>";


	options.addons = [];
	var addon = new Object();
	addon.target = "Both";
	addon.id = "IframeMessenger";
	addon.config = {enable: true};
	options.addons.push(addon);

	function start(){
		VISH.Editor.init(options);
	}
</script>
